<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Vraj Clicker 2</title>
    <style>
        :root {
            --bg: #05070a;
            --panel: rgba(22, 27, 46, 0.95);
            --accent: #22d3ee;
            --gold: #fbbf24;
            --text: #f8fafc;
            --primary: #6c5ce7;
        }

        * { user-select: none; -webkit-user-select: none; outline: none; box-sizing: border-box; }
        body { font-family: 'Inter', sans-serif; background: var(--bg); color: var(--text); margin: 0; height: 100vh; display: flex; justify-content: center; align-items: center; overflow: hidden; }
        .hidden { display: none !important; }

        /* --- AUTH SCREENS --- */
        .auth-screen { background: var(--panel); padding: 2.5rem; border-radius: 24px; text-align: center; width: 90%; max-width: 400px; border: 1px solid #1e293b; }
        input { width: 100%; padding: 14px; margin: 8px 0; border-radius: 12px; border: 1px solid #334155; background: #0f172a; color: white; }
        .btn { background: var(--primary); color: white; border: none; padding: 14px 28px; border-radius: 12px; cursor: pointer; font-weight: 700; width: 100%; margin-top: 10px; }

        /* --- GAME LAYOUT --- */
        #screen-game { display: grid; grid-template-columns: 320px 1fr 320px; width: 100vw; height: 100vh; }
        .panel { background: var(--panel); border: 1px solid #1e293b; padding: 20px; overflow-y: auto; display: flex; flex-direction: column; }
        .center-area { display: flex; flex-direction: column; align-items: center; justify-content: center; background: radial-gradient(circle, #1e293b 0%, #05070a 100%); position: relative; }

        /* --- UI ELEMENTS --- */
        #score-display { font-size: 3.5rem; color: var(--gold); font-weight: 900; text-shadow: 0 0 20px rgba(251, 191, 36, 0.3); }
        #main-clicker { 
            width: 280px; height: 280px; border-radius: 50%; border: 10px solid var(--accent);
            background: url('https://i.imgur.com/GscT2bX.png') center/cover;
            cursor: pointer; transition: 0.05s; box-shadow: 0 0 40px rgba(34, 211, 238, 0.3);
        }
        #main-clicker:active { transform: scale(0.95); }

        .upgrade-card { background: rgba(0,0,0,0.3); padding: 12px; border-radius: 10px; margin-bottom: 8px; cursor: pointer; border: 1px solid #333; display: flex; justify-content: space-between; align-items: center; }
        .upgrade-card:hover { border-color: var(--accent); background: rgba(255,255,255,0.05); }
        
        /* --- ACHIEVEMENTS --- */
        #achievement-pop { position: fixed; bottom: 20px; right: 20px; background: var(--gold); color: #000; padding: 15px 25px; border-radius: 12px; font-weight: bold; transform: translateX(200%); transition: 0.5s; z-index: 1000; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        #achievement-pop.show { transform: translateX(0); }

        .lb-row { display: flex; justify-content: space-between; padding: 8px; font-size: 0.9rem; border-bottom: 1px solid #333; }
        .top1 { color: var(--gold); font-weight: bold; background: rgba(251, 191, 36, 0.1); }
    </style>
</head>
<body oncontextmenu="return false;">

    <div id="achievement-pop">üèÜ Achievement Unlocked!</div>

    <div id="screen-menu" class="auth-screen">
        <h1>Vraj Clicker 2</h1>
        <button class="btn" onclick="showAuth('screen-login')">Login</button>
        <button class="btn" onclick="showAuth('screen-signup')" style="background:#4834d4">Sign Up</button>
    </div>

    <div id="screen-login" class="auth-screen hidden">
        <h3>Welcome Back</h3>
        <input type="email" id="l-email" placeholder="Email">
        <input type="password" id="l-pass" placeholder="Password">
        <button class="btn" id="do-login">Login</button>
        <button onclick="showAuth('screen-menu')" style="background:none; color:#94a3b8; border:none; margin-top:10px; cursor:pointer;">Back</button>
    </div>

    <div id="screen-signup" class="auth-screen hidden">
        <h3>New Player</h3>
        <input type="text" id="s-user" placeholder="Username">
        <input type="email" id="s-email" placeholder="Email">
        <input type="password" id="s-pass" placeholder="Password">
        <button class="btn" id="do-signup">Sign Up</button>
        <button onclick="showAuth('screen-menu')" style="background:none; color:#94a3b8; border:none; margin-top:10px; cursor:pointer;">Back</button>
    </div>

    <div id="screen-game" class="hidden">
        <div class="panel">
            <h3 style="color:var(--accent)">VRAJ STORE</h3>
            <div id="upgrade-list"></div>
        </div>
        <div class="center-area">
            <div id="score-display">0</div>
            <div id="cps-display" style="color:var(--accent); margin-bottom:20px; font-weight:bold;">0 per second</div>
            <div id="main-clicker"></div>
            <button onclick="prestige()" id="pres-btn" class="btn" style="width:220px; margin-top:20px;" disabled>PRESTIGE (1M Required)</button>
        </div>
        <div class="panel">
            <h3 style="color:var(--gold)">LEADERBOARD</h3>
            <div id="lb-body"></div>
            <button onclick="logout()" style="margin-top:auto; background:#eb4d4b; border:none; color:white; padding:10px; border-radius:8px; cursor:pointer;">Logout</button>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged, signOut, sendEmailVerification } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { getDatabase, ref, set, update, onValue, query, orderByChild, limitToLast } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        const firebaseConfig = {
            apiKey: "AIzaSyDwg2ZSpQspAD-o19AZCOHcrl9VnYc_sdk",
            authDomain: "vraj-clicker-2.firebaseapp.com",
            projectId: "vraj-clicker-2",
            storageBucket: "vraj-clicker-2.firebasestorage.app",
            messagingSenderId: "162243172716",
            appId: "1:162243172716:web:874a1f8be471a9f0d83b49",
            measurementId: "G-SBJ4W7JRRL"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getDatabase(app);
        let userData = { score: 0, cps: 0, prestige: 0, name: "", counts: {}, achievements: [] };

        // --- 100 UNIQUE UPGRADES ---
        const rawNames = ["Baby Vraj","Toddler Vraj","Preschool Vraj","Primary Vraj","Gamer Vraj","YouTube Vraj","Streamer Vraj","Influencer Vraj","Entrepreneur Vraj","Tech Vraj","Coding Vraj","Silicon Vraj","Cloud Vraj","AI Vraj","Quantum Vraj","Space Vraj","Lunar Vraj","Mars Vraj","Jupiter Vraj","Solar Vraj","Galactic Vraj","Nebula Vraj","Star Vraj","Void Vraj","Eternal Vraj","Godly Vraj","Multiverse Vraj","Infinite Vraj","Alpha Vraj","Omega Vraj"];
        const storeItems = [];
        for(let i=0; i<100; i++) {
            let nameBase = rawNames[i % rawNames.length];
            storeItems.push({ id: 'u'+i, name: `${nameBase} (${i+1})`, cost: Math.floor(15 * Math.pow(1.35, i)), power: (i + 1) * Math.pow(1.2, i/2) });
        }

        // --- 100 ACHIEVEMENTS ---
        const achievementGoals = [];
        for(let i=1; i<=100; i++) {
            achievementGoals.push({ id: 'ach'+i, goal: Math.pow(i, 3) * 100, name: `Milestone ${i}: ${Math.floor(Math.pow(i, 3)*100).toLocaleString()} Clicks` });
        }

        window.showAuth = (id) => {
            document.querySelectorAll('.auth-screen').forEach(s => s.classList.add('hidden'));
            document.getElementById(id).classList.remove('hidden');
        };

        document.getElementById('do-signup').onclick = () => {
            const u = document.getElementById('s-user').value, e = document.getElementById('s-email').value, p = document.getElementById('s-pass').value;
            createUserWithEmailAndPassword(auth, e, p).then(res => {
                sendEmailVerification(res.user);
                set(ref(db, 'users/' + res.user.uid), { name: u, score: 0, cps: 0, prestige: 0, counts: {}, achievements: [] });
                alert("Check email to verify!");
            }).catch(err => alert(err.message));
        };

        document.getElementById('do-login').onclick = () => {
            signInWithEmailAndPassword(auth, document.getElementById('l-email').value, document.getElementById('l-pass').value)
                .catch(err => alert("Login Error: " + err.message));
        };

        onAuthStateChanged(auth, user => {
            if(user && user.emailVerified) {
                showAuth('screen-game'); // Switch to game immediately
                onValue(ref(db, 'users/' + user.uid), s => { 
                    if(s.exists()){ 
                        userData = s.val(); 
                        userData.counts = userData.counts || {}; 
                        userData.achievements = userData.achievements || [];
                        updateUI(); 
                    }
                });
            } else { showAuth('screen-menu'); }
        });

        document.getElementById('main-clicker').onclick = () => {
            userData.score += (1 + (userData.cps * 0.1)) * Math.pow(2, userData.prestige);
            checkAchievements();
            save();
        };

        window.buy = (id) => {
            const item = storeItems.find(i => i.id === id);
            const count = userData.counts[id] || 0;
            const cost = Math.floor(item.cost * Math.pow(1.15, count));
            if(userData.score >= cost) {
                userData.score -= cost;
                userData.counts[id] = count + 1;
                let total = 0;
                storeItems.forEach(si => { total += (si.power * (userData.counts[si.id] || 0)); });
                userData.cps = total;
                save();
            }
        };

        function checkAchievements() {
            achievementGoals.forEach(a => {
                if(userData.score >= a.goal && !userData.achievements.includes(a.id)) {
                    userData.achievements.push(a.id);
                    const pop = document.getElementById('achievement-pop');
                    pop.innerText = "üèÜ Unlocked: " + a.name;
                    pop.classList.add('show');
                    setTimeout(() => pop.classList.remove('show'), 4000);
                }
            });
        }

        window.prestige = () => {
            if(userData.score >= 1000000) {
                userData.prestige += 1; userData.score = 0; userData.cps = 0; userData.counts = {};
                save(); alert("Ascended! Permanent 2x boost applied.");
            }
        };

        function save() { if(auth.currentUser) update(ref(db, 'users/' + auth.currentUser.uid), userData); }

        function updateUI() {
            document.getElementById('score-display').innerText = Math.floor(userData.score).toLocaleString();
            document.getElementById('cps-display').innerText = `${userData.cps.toFixed(1)} per second`;
            document.getElementById('pres-btn').disabled = userData.score < 1000000;
            const list = document.getElementById('upgrade-list');
            list.innerHTML = "";
            storeItems.slice(0, Object.keys(userData.counts).length + 3).forEach(item => {
                const count = userData.counts[item.id] || 0;
                const cost = Math.floor(item.cost * Math.pow(1.15, count));
                list.innerHTML += `<div class="upgrade-card" onclick="buy('${item.id}')"><div><span style="font-weight:bold;color:var(--accent)">${item.name}</span><br><span style="font-size:0.8rem;color:var(--gold)">${cost.toLocaleString()} clicks</span></div><div>x${count}</div></div>`;
            });
        }

        onValue(query(ref(db, 'users'), orderByChild('score'), limitToLast(10)), s => {
            const b = document.getElementById('lb-body'); b.innerHTML = "";
            let p = []; s.forEach(c => p.push(c.val()));
            p.reverse().forEach((u, i) => { b.innerHTML += `<div class="lb-row ${i==0?'top1':''}"><span>#${i+1} ${u.name}</span><span>${Math.floor(u.score).toLocaleString()}</span></div>`; });
        });

        window.logout = () => signOut(auth).then(() => location.reload());
        setInterval(() => { if(auth.currentUser?.emailVerified && userData.cps > 0){ userData.score += (userData.cps * 0.1); save(); }}, 1000);
    </script>
</body>
</html>
